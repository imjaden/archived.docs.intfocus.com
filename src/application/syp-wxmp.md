---
title: 胜因学院(小程序)
type: 胜因学院(小程序)
---

## 业务流程图

![胜因学院小程序-业务流程](/images/胜因学院小程序-业务流程.png)

## 我的-积分

![胜因学院小程序-业务流程](/images/小程序-我的-积分.png)

积分主要用于小程序消息的推送；简单来讲，微信为了避免小程序对用户滥发消息推送，通过引导用户创建积分(FormId)的方式，约束每推送用户一条消息需要消耗一积分；每个积分有效期七天，长期（大于七天）不使用小程序的用户也收不到推送消息。

## 积分说明

![小程序积分说明](/images/小程序积分说明.png)

[模板消息-微信小程序官方](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/template-message.html):
> 步骤一：获取模板 ID
> 步骤二：页面的 form 组件，属性 report-submit 为 true 时，可以声明为需要发送模板消息，此时点击按钮提交表单可以获取 formId，用于发送模板消息。或者当用户完成 支付行为，可以获取 prepay_id 用于发送模板消息。
> 步骤三：调用接口下发模板消息

## 胜因学院小程序积分说明

### Where

- 胜因学院-我的-积分

![胜因学院-我的-积分](/images/胜因学院-我的-积分.png)

### What

- 这里的积分，其实就是formID,每一个积分代表一个formID
- formID用于给用户推送模板消息，每一个formID可推送一条模板消息
- 模板消息就是小程序的服务通知，只有在业务有需要的时候才会给用户推送

![推送消息](/images/推送消息.png)

### When

- 每一位微信用户有其唯一识别的openID，每一个openID可对应多个formID
- 根据业务需要，我们会在某些特定的表单处埋点，当用户提交这些表单，即可获取该用户的formID，一次提交行为对应一个formID
- 用户通过提交表单向服务器提交数据，这是真正意义上的表单；但是在胜因学院小程序中，用户点击这些button（如下图所示），向服务器提交的数据为空值，也可算作一次提交表单行为，也可获取一个formID
- 只有在业务有需要的时候才会消耗用户的formID推送模板消息，所以formID可能会有富余，而且formID的有效期是7天，只可使用7天内的formID，多余或过期的formID作废

![提交表单](/images/提交表单.jpeg)

### Why

- 这里的积分数量主要是为了提示客户当前能推送多少条模板消息，避免相互追责

### How

> 步骤一：获取模板 ID
> 步骤二：页面的 form 组件，属性 report-submit 为 true 时，可以声明为需要发送模板消息，此时点击按钮提交表单可以获取 formId，用于发送模板消息。或者当用户完成 支付行为，可以获取 prepay_id 用于发送模板消息。
> 步骤三：调用接口下发模板消息
